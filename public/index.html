<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>KCSE & Courses PDF Library</title>
<style>
body {
  font-family: Georgia, serif;
  background: #f4f4f4;
  margin:0;
  padding:20px;
}
h1 {
  text-align:center;
  color:#003366;
}
ul {
  max-width: 800px;
  margin:auto;
  padding:0;
  list-style:none;
}
li {
  background:#fff;
  margin:10px 0;
  padding:15px 20px;
  font-size:18px;
  border-left:6px solid #00b894;
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  transition:0.2s;
}
li:hover {
  background:#e0f7fa;
}
</style>
</head>
<body>
<h1>KCSE & Courses PDF Library</h1>
<ul id="exam-list"></ul>

<script>
const spreadsheetId = "1X8XY51OIVpMX5BMsnnsEpuuYsdvRsnSxbmWFbidbTBs";
const ul = document.getElementById("exam-list");

// List of sheets you have created
const sheets = [
  "Sheet1",
  "Sheet2",
  "Sheet3",
  "Sheet4",
  "Sheet5"
  // Add more sheets here as you create them
];

async function loadSheets() {
  let count = 1; // for numbering visible links
  for(const sheetName of sheets){
    const sheetURL = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
    try {
      const res = await fetch(sheetURL);
      const text = await res.text();
      const json = JSON.parse(text.substring(47,text.length-2));

      const firstRow = json.table.rows?.[0]?.c || [];
      const title = firstRow[0]?.v;

      // Only add if title exists
      if(title && title.trim() !== ""){
        const li = document.createElement("li");
        li.textContent = `${count}. ${title}`;
        li.addEventListener("click",()=> {
          window.location.href = `pdf-view.html?sheet=${sheetName}&title=${encodeURIComponent(title)}`;
        });
        ul.appendChild(li);
        count++;
      }

    } catch(e) {
      console.log(`Error reading ${sheetName}:`, e);
    }
  }
}

loadSheets();
</script>
</body>
</html>
