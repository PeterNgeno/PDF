<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>KCSE & Courses PDF Library</title>
<style>
body {
  font-family: Georgia, serif;
  background: #f4f4f4;
  margin:0;
  padding:20px;
}
h1 {
  text-align:center;
  color:#003366;
  margin-bottom:30px;
}
ul {
  max-width: 900px;
  margin:auto;
  padding:0;
  list-style:none;
}
li {
  background:#fff;
  margin:10px 0;
  padding:15px 20px;
  font-size:18px;
  border-left:6px solid #00b894;
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  transition:0.2s;
  border-radius:8px;
}
li:hover {
  background:#e0f7fa;
}
</style>
</head>
<body>
<h1>KCSE & Courses PDF Library</h1>
<ul id="exam-list"></ul>

<script>
const spreadsheetId = "1X8XY51OIVpMX5BMsnnsEpuuYsdvRsnSxbmWFbidbTBs";
const sheetName = "Sheet1"; // Only one sheet needed; each row = one PDF
const ul = document.getElementById("exam-list");

async function loadPDFs() {
  const sheetURL = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
  try {
    const res = await fetch(sheetURL);
    const text = await res.text();
    const json = JSON.parse(text.substring(47, text.length-2));
    const rows = json.table.rows;

    rows.forEach((row, index) => {
      const title = row.c[0]?.v;
      if(title && title.trim() !== "") {
        const li = document.createElement("li");
        li.textContent = `${index+1}. ${title}`;
        li.addEventListener("click", () => {
          // Redirect to pdf-view with row and sheet info
          const url = `pdf-view.html?sheet=${encodeURIComponent(sheetName)}&row=${index}`;
          window.location.href = url;
        });
        ul.appendChild(li);
      }
    });

  } catch(e) {
    console.error("Error loading sheet:", e);
    ul.innerHTML = "<li>Unable to load PDFs. Please check the sheet.</li>";
  }
}

loadPDFs();
</script>
</body>
</html>
